<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Nodos Docker</title>
    <style>
        body { font-family: sans-serif; background-color: #1a1a1a; color: #f0f0f0; display: flex; flex-direction: column; align-items: center; }
        h1 { color: #4a90e2; }
        #dashboard { display: flex; justify-content: center; gap: 20px; margin-top: 30px; }
        .nodo { width: 150px; height: 150px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 1.2em; font-weight: bold; transition: background-color 0.5s ease; border: 3px solid #333; }
        .offline { background-color: #ff4d4d; animation: blinker 1.5s linear infinite; }
        .online { background-color: #4caf50; animation: none; }
        @keyframes blinker { 50% { opacity: 0.3; } }
    </style>
</head>
<body>
    <h1>Dashboard de Nodos Docker</h1>
    <div id="dashboard">
        {% for nodo in nodos %}
            <div id="{{ nodo }}" class="nodo offline">{{ nodo.replace('_', ' ').title() }}</div>
        {% endfor %}
    </div>

    <script>
        // Función para actualizar el estado de los nodos
        async function actualizarStatus() {
            try {
                const response = await fetch('/status');
                const statuses = await response.json();

                for (const nodo in statuses) {
                    const nodoDiv = document.getElementById(nodo);
                    if (statuses[nodo] === "online") {
                        nodoDiv.classList.remove('offline');
                        nodoDiv.classList.add('online');
                    } else {
                        nodoDiv.classList.remove('online');
                        nodoDiv.classList.add('offline');
                    }
                }
            } catch (error) {
                console.error("Error al obtener el estado:", error);
            }
        }

        // Llama a la función cada 2 segundos
        setInterval(actualizarStatus, 2000);
        // Llama una vez al cargar la página
        actualizarStatus();
    </script>
</body>
</html>